---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "pulsar_schema Resource - terraform-provider-pulsar"
subcategory: ""
description: |-
  Manages Pulsar schemas for topics. Schemas provide a way to enforce structure and compatibility for messages in Pulsar topics.
---

# pulsar_schema (Resource)

Manages Pulsar schemas for topics. Schemas provide a way to enforce structure and compatibility for messages in Pulsar topics. Schema updates create new versions rather than modifying existing schemas, enabling schema evolution and compatibility validation.

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `tenant` (String) The tenant name. Cannot be changed after creation.
- `namespace` (String) The namespace name. Cannot be changed after creation.
- `topic` (String) The topic name. Cannot be changed after creation.
- `type` (String) Schema type. Supported types include:
  - **Primitive types**: `STRING`, `INT8`, `INT16`, `INT32`, `INT64`, `FLOAT`, `DOUBLE`, `BOOLEAN`, `BYTES`, `TIMESTAMP`, `DATE`, `TIME`, `INSTANT`, `LOCAL_DATE`, `LOCAL_TIME`, `LOCAL_DATE_TIME`
  - **Complex types**: `AVRO`, `JSON`, `PROTOBUF`, `PROTOBUF_NATIVE`, `KEY_VALUE`
  - **Auto types**: `AUTO_CONSUME`, `AUTO_PUBLISH`, `AUTO_PRODUCE_BYTES`

### Optional

- `schema_data` (String) Schema definition data. Required for complex types (`AVRO`, `JSON`, `PROTOBUF`, `PROTOBUF_NATIVE`, `KEY_VALUE`). Not needed for primitive types.
- `properties` (Map of String) Additional schema properties as key-value pairs.

### Read-Only

- `id` (String) The ID of this resource in the format `tenant/namespace/topic`.
- `version` (Number) Current schema version. Automatically incremented when schema is updated.

## Example Usage

### Simple String Schema

```hcl
resource "pulsar_schema" "user_events" {
  tenant    = "my-tenant"
  namespace = "my-namespace"
  topic     = "user-events"
  type      = "STRING"
  
  properties = {
    "owner"       = "data-team"
    "description" = "User activity events"
  }
}
```

### AVRO Schema with Complex Structure

```hcl
resource "pulsar_schema" "user_profile" {
  tenant    = "my-tenant"
  namespace = "my-namespace"
  topic     = "user-profile"
  type      = "AVRO"
  
  schema_data = jsonencode({
    type = "record"
    name = "UserProfile"
    fields = [
      {
        name = "id"
        type = "string"
      },
      {
        name = "email"
        type = "string"
      },
      {
        name = "age"
        type = ["null", "int"]
        default = null
      },
      {
        name = "preferences"
        type = {
          type = "record"
          name = "Preferences"
          fields = [
            {
              name = "theme"
              type = "string"
              default = "light"
            },
            {
              name = "notifications"
              type = "boolean"
              default = true
            }
          ]
        }
      }
    ]
  })
  
  properties = {
    "owner"   = "user-service"
    "version" = "1.0"
  }
}
```

### JSON Schema

```hcl
resource "pulsar_schema" "order_events" {
  tenant    = "ecommerce"
  namespace = "orders"
  topic     = "order-created"
  type      = "JSON"
  
  schema_data = jsonencode({
    type = "object"
    properties = {
      orderId = {
        type = "string"
      }
      customerId = {
        type = "string"
      }
      amount = {
        type = "number"
        minimum = 0
      }
      items = {
        type = "array"
        items = {
          type = "object"
          properties = {
            productId = { type = "string" }
            quantity = { type = "integer", minimum = 1 }
            price = { type = "number", minimum = 0 }
          }
          required = ["productId", "quantity", "price"]
        }
      }
    }
    required = ["orderId", "customerId", "amount", "items"]
  })
  
  properties = {
    "service" = "order-service"
    "env"     = "production"
  }
}
```

### Protobuf Schema

```hcl
resource "pulsar_schema" "metrics" {
  tenant    = "monitoring"
  namespace = "metrics"
  topic     = "system-metrics"
  type      = "PROTOBUF"
  
  schema_data = <<EOF
syntax = "proto3";

message SystemMetrics {
  string host = 1;
  int64 timestamp = 2;
  double cpu_usage = 3;
  double memory_usage = 4;
  double disk_usage = 5;
  map<string, string> labels = 6;
}
EOF

  properties = {
    "collector" = "prometheus"
    "interval"  = "30s"
  }
}
```

## Import

Schemas can be imported using the format `tenant/namespace/topic`:

```shell
terraform import pulsar_schema.example my-tenant/my-namespace/my-topic
```

## Notes

### Schema Evolution

- Schema updates create new versions rather than modifying existing schemas
- The `version` field is automatically incremented when schemas are updated
- Pulsar handles schema compatibility validation server-side
- Clients can specify which schema version to use when producing/consuming messages

### Schema Data Requirements

- **Complex types** (`AVRO`, `JSON`, `PROTOBUF`, `PROTOBUF_NATIVE`, `KEY_VALUE`) require `schema_data`
- **Primitive types** (`STRING`, `INT32`, `BOOLEAN`, etc.) do not require `schema_data`
- **Auto types** do not require `schema_data` as they're inferred from message content

### Resource Identity

- The combination of `tenant`, `namespace`, and `topic` forms the unique identity
- These fields cannot be changed after resource creation (marked as `ForceNew`)
- Changing any of these values will destroy and recreate the resource

### Topic Format

- The resource automatically uses the `persistent://` topic format
- Topic names are validated and formatted using Pulsar's naming conventions